{"version":3,"file":"vue.js","sources":["../../src/util.js","../../src/observer/array.js","../../src/observer/dep.js","../../src/observer/index.js","../../src/observer/schduler.js","../../src/observer/watcher.js","../../src/state.js","../../src/compiler/parse.js","../../src/compiler/generate.js","../../src/compiler/index.js","../../src/vdom/patch.js","../../src/lifecycle.js","../../src/init.js","../../src/vdom/index.js","../../src/global-api/extend.js","../../src/global-api/index.js","../../src/index.js"],"sourcesContent":["export function proxy (vm, data, key) {\n\n  Object.defineProperty(vm, key, {\n    get () {\n      return vm[data][key]\n    },\n    set (val) {\n      vm[data][key] = val\n    }\n  })\n}\n\nexport function defineProperty (target, key, value) {\n  Object.defineProperty(target, key, {\n    enumerable: false,\n    configurable: false,\n    value\n  })\n}\nexport const LIFECYCLE_HOOKS = [\n  'beforeCreate',\n  'created',\n  'beforeMount',\n  'mounted',\n  'beforeUpdate',\n  'updated',\n  'beforeDestroy',\n  'destroyed'\n]\nconst strats = {}\n\n// parentVal 是 全局的components\n// 组件的合并策略是最近策略，先找自己的再找全局的 - 原型链！， 将全局组件放在原型链上。\nstrats.components = function (parentVal, childVal) {\n  let res = Object.create(parentVal)\n  if (childVal) {\n    for (let key in childVal) {\n      res[key] = childVal[key]\n    }\n  }\n  return res\n}\n\nLIFECYCLE_HOOKS.forEach(hook => {\n  strats[hook] = mergeHook\n})\n\nfunction mergeHook (parentVal, childVal) {\n  if (childVal) {\n    if (parentVal) {\n      return parentVal.concat(childVal)\n    } else {\n      return [childVal]\n    }\n  }\n}\n\nexport function mergeOptions (parent, child) {\n  const options = {}\n  for (let key in parent) {\n    mergeField(key)\n  }\n  for (let key in child) {\n    if (!parent.hasOwnProperty(key)) {\n      mergeField(key)\n    }\n  }\n  function mergeField (key) {\n    if (strats[key]) {\n      options[key] = strats[key](parent[key], child[key])\n    } else {\n      options[key] = child[key]\n    }\n  }\n  return options\n}\n\nexport function callHook(vm, hook) {\n  const handlers = vm.$options[hook]\n  if (handlers) {\n    handlers.forEach(handler => {\n      handler.call(vm)\n    })\n  }\n}\n\n\n\nconst callbacks = [];\nlet pending = false;\nfunction flushCallbacks(){\n    console.log('callbacks', callbacks)\n    while (callbacks.length) {\n        let cb = callbacks.shift();\n        cb();\n    } // 让nextTick中传入的方法依次执行\n    pending = false // 标识已经执行完毕\n}\nlet timerFunc;\nif(Promise){\n    timerFunc = ()=>{\n        Promise.resolve().then(flushCallbacks); // 异步处理更新\n    }\n}else if(MutationObserver){ // 可以监控dom变化,监控完毕后是异步更新\n    let observe = new MutationObserver(flushCallbacks);\n    let textNode = document.createTextNode(1); // 先创建一个文本节点\n    observe.observe(textNode,{characterData:true}); // 观测文本节点中的内容\n    timerFunc = ()=>{\n        textNode.textContent = 2; // 文中的内容改成2\n    }\n}else if(setImmediate){\n    timerFunc = ()=>{\n        setImmediate(flushCallbacks)\n    }\n}else{\n    timerFunc = ()=>{\n        setTimeout(flushCallbacks)\n    }\n}\nexport function nextTick(cb){ // 因为内部会调用nextTick 用户也会调用，但是异步只需要一次\n    callbacks.push(cb);\n    if(!pending){\n        // vue3 里的nextTick原理就是promise.then 没有做兼容性处理了\n        timerFunc();// 这个方法是异步方法 做了兼容处理了\n        pending = true;\n    }\n}\n\nfunction makeMap(str) {\n  const mapping = {};\n  const list = str.split(',');\n  for(let i =0; i< list.length;i++){\n      mapping[list[i]] = true;\n  }\n  return (key)=>{ // 判断这个标签名是不是原生标签\n      return mapping[key];\n  }\n}\n\nexport const isReservedTag = makeMap(\n  'a,div,img,image,text,span,p,button,input,textarea,ul,li'\n)","const oldArrayProtoMethods = Array.prototype\n\nexport let arrayMethods = Object.create(oldArrayProtoMethods)\nlet methods = [\n  'push',\n  'pop',\n  'shift',\n  'unshift',\n  'reverse',\n  'sort',\n  'splice'\n]\nmethods.forEach(method => {\n  arrayMethods[method] = function(...args) {\n    const result = oldArrayProtoMethods[method].apply(this, args)\n    let inserted\n    let ob = this.__ob__ // this指向的是调用着，也就是数组类型的data，在Observer包装data的时候，就初始化来__ob__给data， 所以这个data有__ob__属性， 指向的是Observer, 就有observeArray的方法来\n    switch (method) {\n      case 'push': // arr.push({a:1},{b:2})\n      case 'unshift': //这两个方法都是追加 追加的内容可能是对象类型，应该被再次进行劫持\n          inserted = args;\n          break;\n      case 'splice': // vue.$set原理\n          inserted = args.slice(2); // arr.splice(0,1,{a:1},{a:1},{a:1})\n      default:\n          break;\n    }\n    if(inserted) ob.observeArray(inserted); // 给数组新增的值也要进行观测\n    ob.dep.notify()\n    return result\n  }\n})","// depend依赖, 收集依赖的\nlet id = 0\nclass Dep {\n  constructor () {\n    this.subs = []\n    this.id = id++\n  }\n  // 建立关联，依赖关系\n  depend () {\n    // Dep.target.addDep(this)\n    Dep.target.addDep(this)\n  }\n  // 往中介添加\n  addSub (watcher) {\n    this.subs.push(watcher)\n  }\n  // 通知\n  notify () {\n    this.subs.forEach(watcher => watcher.update())\n  }\n}\nDep.target = null;\nexport function pushTarget (watcher) {\n  Dep.target = watcher\n}\n\nexport function popTarget () {\n  Dep.target = null\n}\nexport default Dep","import { defineProperty } from \"../util\";\nimport { arrayMethods } from \"./array\";\nimport Dep from './dep'\n\nexport function observe(data) {\n  if(typeof data !== 'object' || data == null){\n      return;\n  }\n  if(data.__ob__){\n      return data;\n  }\n  return new Observer(data) // 包装data\n}\n\nclass Observer {\n  constructor (data) {\n    this.dep = new Dep()\n    defineProperty(data, '__ob__', this)\n    if (Array.isArray(data)) {\n      data.__proto__ = arrayMethods\n      this.observeArray(data)\n    }\n    this.walk(data)\n  }\n  walk(data) {\n    const keys = Object.keys(data)\n    keys.forEach(key => {\n      defineReactive(data, key, data[key])\n    })\n  }\n  observeArray (data) {\n    for(let i = 0; i < data.length;i++) {\n      observe(data[i])\n    }\n  }\n}\nfunction defineReactive(data, key, value) {\n  let valueObserver = observe(value)\n  const dep = new Dep()\n  Object.defineProperty(data, key, {\n    get () {\n      console.log(key, Dep.target)\n      if (Dep.target) {\n        dep.depend()\n        if (valueObserver) {\n          valueObserver.dep.depend()\n        }\n      }\n      return value\n    },\n    set (newValue) {\n      if(newValue === value) return;\n      observe(newValue)\n      value = newValue\n      dep.notify()\n    }\n  })\n}","import { nextTick } from \"../util\"\nimport Watcher from \"./watcher\";\n\nlet has = {}\nlet queue = []\nlet pending = false;\nexport function queueWatcher(watcher) {\n  let id = watcher\n  if (has[id] ==null) {\n    queue.push(watcher)\n    has[id] = true\n    // 开启异步，会等待所有同步后再执行\n    // setTimeout(() => {\n    //   flushSchedulerQueue()\n    // }, 0)\n    if (!pending) {\n        nextTick(flushSchedulerQueue)\n        pending = true\n    }\n  }\n}\n\nexport function flushSchedulerQueue () {\n  queue.forEach(watcher =>{\n    watcher.run()\n    if (!watcher.user) {\n        watcher.cb()\n    }\n  });\n  queue = [];\n  has = {};\n  pending = false\n}","// 观察者.js\nimport { pushTarget, popTarget } from \"./dep\";\nimport { queueWatcher } from \"./schduler\";\nlet id = 0\nclass Watcher {\n  constructor (vm, exprOrFn, cb, options) {\n    this.id = id++\n    this.deps = [] // watcher记录有多少dep依赖他\n    this.depsId = new Set()\n    this.vm = vm\n    this.exprOrFn = exprOrFn\n    this.cb = cb\n    this.options = options\n    /**\n     * var obj = true; obj.user // undefined\n     */\n    this.user = options.user\n    this.lazy = options.lazy // lazy代表的是computed计算属性\n    this.dirty = this.lazy\n    if (typeof exprOrFn === 'function') {\n      this.getter = exprOrFn\n    } else {\n      this.getter = function() {\n        // 拿到实例上的值\n        let path = exprOrFn.split('.')\n        let obj = vm\n        for (let i = 0; i < path.length; i++) {\n          obj = obj[path[i]]\n        }\n        return obj\n      }\n    }\n    this.value = this.lazy ? void 0 : this.get() // 默认先调用一次get，进行取值，将结果赋值给this.value\n    // 比如 vm.a.a 的值\n  }\n  get () {\n    pushTarget(this)\n    let result = this.getter.call(this.vm)\n    popTarget()\n    return result\n  }\n\n  addDep (dep) {\n    let id = dep.id\n    if (!this.depsId.has(id)) {\n      this.deps.push(dep)\n      this.depsId.add(id)\n      dep.addSub(this)\n    }\n  }\n  // 更新值后，批量更新最后会走到run\n  // 如果是watch，那么this.value是老值，this.get()是新值\n  run () {\n    // this.get()\n    console.log('run')\n    let newValue = this.get()\n    let oldValue = this.value\n    this.value = newValue\n    if (this.user) { // 如果是用户watcher, 监听watch\n      this.cb.call(this.vm, newValue, oldValue)\n    }\n  }\n  update () {\n    console.log('update', this)\n    // this.run()\n    if (this.lazy) {  // 是计算属性\n      this.dirty = true\n    } else {\n      queueWatcher(this)\n    }\n  }\n\n  evaluate () {\n    this.value = this.get()\n    this.dirty = false // 变化后更新状态，表示已经是最新的 无\"杂质\"\n  }\n\n  depend (){\n    // 计算属性watcher 会存储 dep  dep会存储watcher\n\n    // 通过watcher找到对应的所有dep，让所有的dep 都记住这个渲染watcher\n    let i = this.deps.length;\n    while(i--){\n      this.deps[i].depend(); // 让dep去存储渲染watcher\n    }\n  }\n}\n\n\n\nexport default Watcher\n","import { nextTick, proxy } from \"./util\"\nimport { observe } from \"./observer/index\"\nimport Watcher from \"./observer/watcher\"\nimport Dep from \"./observer/dep\";\n\nexport function initState(vm) {\n  const opts = vm.$options\n  if (opts.props) {\n    initProps(vm)\n  }\n  if (opts.data) {\n    initData(vm)\n  }\n  if (opts.watch) {\n    initWatch(vm)\n  }\n  if (opts.computed) {\n    initComputed(vm)\n  }\n}\nfunction initProps(){}\nfunction initData(vm) { // 数据初始化\n  let data = vm.$options.data\n  vm._data = data = typeof data === 'function' ? data.call(vm) : data\n  for (let key in data) {\n    proxy(vm, '_data', key)\n  }\n  observe(data)\n}\n\nfunction initWatch(vm) {\n  let watch = vm.$options.watch\n  for(let key in watch){\n    const handler = watch[key]; // handler可能是 \n    if(Array.isArray(handler)){ // 数组 、\n        handler.forEach(handle=>{\n            createWatcher(vm,key,handle);\n        });\n    }else{\n        createWatcher(vm,key,handler); // 字符串 、 对象 、 函数\n    }\n  }\n}\n/**\n *   可能是一个函数，所以key就叫它exprOrFn好老\n *      vm.$watch(()=>{\n            return vm.a.a.a; // 老值\n        },(newValue,oldValue)=>{\n            console.log(newValue,oldValue,'自己写的$watch')\n        })\n */\n// options 可以用来标识 是用户watcher\nfunction createWatcher (vm, exprOrFn, handler, options) {\n  if(typeof handler == 'object'){\n    options = handler\n    handler = handler.handler; // 是一个函数\n  }\n  if(typeof handler == 'string'){ // methods的情况\n      handler = vm[handler]; // 将实例的方法作为handler\n  }\n  // key handler 用户传入的选项\n  return vm.$watch(exprOrFn,handler,options)\n}\n\nexport function stateMixin(Vue){\n  Vue.prototype.$nextTick = function (cb) {\n      nextTick(cb);\n  }\n  Vue.prototype.$watch = function (exprOrFn,cb,options = {}) {\n    console.log('$watch', this)\n      // 数据应该依赖这个watcher  数据变化后应该让watcher从新执行\n      let watcher = new Watcher(this,exprOrFn,cb,{...options,user:true});\n      if(options.immediate){\n          cb(); // 如果是immdiate应该立刻执行\n      }\n  }\n}\n\nfunction initComputed (vm) {\n  let computed = vm.$options.computed\n  const watchers = vm._computedWathcers = {} // computed的watcher\n  for (let key in computed) {\n    const userDef = computed[key]\n    const getter = typeof userDef === 'function' ? userDef : userDef.get\n    watchers[key] = new Watcher(vm, getter, () => {}, { lazy: true })\n    defineComputed(vm, key, userDef) // defineReactive()\n  }\n}\n\nfunction defineComputed (vm, key, userDef) {\n    const definition = {\n        enumerable: true, // 是否可枚举\n        configurable: true,\n        get: () => {},\n        set: () => {}\n    }\n    if (typeof userDef == 'function') {\n        definition.get = createComputedGetter(key)\n    } else {\n        definition.get = createComputedGetter(key)\n        definition.set = userDef.set\n    }\n    Object.defineProperty(vm, key, definition)\n    console.log(vm)\n}\nfunction createComputedGetter (key) {\n  return function () {\n    const watcher = this._computedWathcers[key]\n\n    if (watcher) {\n      if (watcher.dirty) {\n        watcher.evaluate() // 对当前watcher求值\n      }\n      if (Dep.target) { // 说明还有渲染watcher，也应该一并的收集起来\n        watcher.depend()\n      }\n      return watcher.value // 默认返回watcher上存的值\n    }\n  }\n}","\n\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // 标签名\n// ?:匹配不捕获\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; // </my:xx>\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 标签开头的正则 捕获的内容是标签名\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签结尾的 </div>\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性的    aaa=\"aaa\"  a='aaa'   a=aaa\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配标签结束的 >    >   <div></div>  <br/>\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g;\n// 数据结构 树、栈、链表、队列、\nexport function parseHTML(html) {\n    function createASTElement(tagName, attrs) {\n        return {\n            tag: tagName, // 标签名\n            type: 1, // 元素类型\n            children: [], // 孩子列表\n            attrs, // 属性集合\n            parent: null // 父元素\n        }\n    }\n    let root;\n    let currentParent;\n    let stack = [];\n    function start(tagName, attrs) { // 创建一个元素 作为根元素\n        let element = createASTElement(tagName, attrs);\n        if(!root){\n            root = element;\n        }\n        currentParent = element; // 当前解析的标签 保存起来\n        stack.push(element); // 将生产的ast元素放到栈中\n    }\n\n    // <div> <p></p> hello</div>    currentParent=p\n    function end(tagName) { // 在结尾标签处 创建父子关系\n        let element = stack.pop(); // 取出栈中的最后一个\n        currentParent = stack[stack.length-1];\n        if(currentParent){ // 在闭合时可以知道这个标签的父亲是谁\n            element.parent = currentParent;\n            currentParent.children.push(element);\n        }\n    }\n    function chars(text) {\n        text = text.trim();\n        if(text){\n            currentParent.children.push({\n                type:3,\n                text\n            })\n        }\n    }\n\n    while (html) { // 只要html不为空字符串就一直解析\n        let textEnd = html.indexOf('<');\n        if (textEnd == 0) {\n            // 肯定是标签\n            const startTagMatch = parseStartTag(); // 开始标签匹配的结果 处理开始\n            if (startTagMatch) {\n                start(startTagMatch.tagName, startTagMatch.attrs);\n                continue;\n            }\n            const endTagMatch = html.match(endTag);\n            if (endTagMatch) { // 处理结束标签\n                advance(endTagMatch[0].length);\n                end(endTagMatch[1]); // 将结束标签传入\n                continue;\n            }\n        }\n        let text;\n        if (textEnd > 0) { // 是处理文本\n            text = html.substring(0, textEnd)\n        }\n        if (text) { // 处理文本\n            advance(text.length);\n            chars(text);\n        }\n\n    }\n\n    function advance(n) { // 将字符串进行截取操作 在更新html内容\n        html = html.substring(n)\n    }\n\n    function parseStartTag() {\n        const start = html.match(startTagOpen);\n        if (start) {\n            const match = {\n                tagName: start[1],\n                attrs: []\n            }\n            advance(start[0].length); // 删除开始标签\n            // 如果直接是闭合标签了 说明没有属性\n            let end, attr;\n            // 不是结尾标签 能匹配到属性\n            while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\n                match.attrs.push({ name: attr[1], value: attr[3] || attr[4] || attr[5] });\n                advance(attr[0].length); // 去掉当前属性\n            }\n            if (end) { // >  删除匹配到的结束标签\n                advance(end[0].length);\n                return match;\n            }\n        }\n    }\n\n    return root;\n}\n","// 编写<div id=\"app\" style=\"color:red\"> hello {{name}} <span>hello</span></div>\n\n// 结果:render(){\n//    return _c('div',{id:'app',style:{color:'red'}},_v('hello'+_s(name)),_c('span',null,_v('hello')))\n//}\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g;\n//  语法层面的转义\nfunction genProps(attrs) { //  id   \"app\"     / style  \"fontSize:12px;color:red\"\n    let str = '';\n    for (let i = 0; i < attrs.length; i++) {\n        let attr = attrs[i];\n        if (attr.name === 'style') {\n            let obj = {}; // 对样式进行特殊的处理\n            attr.value.split(';').forEach(item => {\n                let [key, value] = item.split(':');\n                obj[key] = value;\n            });\n            attr.value = obj;\n        }\n        str += `${attr.name}:${JSON.stringify(attr.value)},`;\n    }\n    return `{${str.slice(0,-1)}}`;\n}\nfunction gen(node) {\n    if (node.type == 1) {\n        return generate(node); // 生产元素节点的字符串\n    } else {\n        let text = node.text; // 获取文本\n        // 如果是普通文本 不带{{}}\n\n        if(!defaultTagRE.test(text)){\n            return `_v(${JSON.stringify(text)})` // _v('hello {{ name }} world {{msg}} aa')   => _v('hello'+_s(name) +'world' + _s(msg))\n        }\n        let tokens = []; // 存放每一段的代码\n        let lastIndex = defaultTagRE.lastIndex = 0; // 如果正则是全局模式 需要每次使用前置为0\n        let match,index; // 每次匹配到的结果\n\n        while(match = defaultTagRE.exec(text)){\n            index = match.index; // 保存匹配到的索引\n            if(index > lastIndex){\n                tokens.push(JSON.stringify(text.slice(lastIndex,index)))\n            }\n            tokens.push(`_s(${match[1].trim()})`);\n            lastIndex = index+match[0].length;\n        }\n        if(lastIndex < text.length){\n            tokens.push(JSON.stringify(text.slice(lastIndex)));\n        }\n        return `_v(${tokens.join('+')})`;\n    }\n}\nfunction genChildren(el) {\n    const children = el.children;\n    if (children) { // 将所有转化后的儿子用逗号拼接起来\n        return children.map(child => gen(child)).join(',')\n    }\n}\nexport function generate(el) {\n    let children = genChildren(el);// 儿子的生成\n    let code = `_c('${el.tag}',${\n        el.attrs.length? `${genProps(el.attrs)}`:'undefined'\n    }${\n        children?`,${children}`:''\n    })`;\n    return code;\n}\n","import { parseHTML } from \"./parse\";\nimport { generate } from \"./generate\";\nexport function compileToFunctions (template) {\n  // return template\n  // 1. 将template转成ast树， 这样做的目的是，用js对象更方便后续操作\n  let ast = parseHTML(template)\n  /* console.log(ast)\n    {\n      attrs: (2) [{…}, {…}]\n      children: (3) [{…}, {…}, {…}]\n      parent: null\n      tag: \"div\"\n      type: 1\n    }\n  */\n  // 2. 优化静态节点\n  // 3. 用ast生成code, 主要是用vue的的方法去包装成code，\n  // 这样在render函数执行时，会用vue原型上的方法去编译render函数\n  let code = generate(ast);\n  // _c('div',{id:\"app\",style:{\"color\":\"red\"}},_c('p',undefined,_v(\"hello world zf\")),_c('li',undefined,_v(_s(school.name))),_c('li',undefined,_v(_s(school.age))))\n  // console.log(code);\n  // 4. 通过new Function + with的方式，生成render函数\n  let render = new Function(`with(this){return ${code}}`)\n  /*\n    with 的用法\n    https://blog.csdn.net/zwkkkk1/article/details/79725934\n  */\n  return render\n}\n","export function patch(oldVnode,vnode){\n    // oldVnode => id#app   vnode 我们根据模板产生的虚拟dom\n    // 将虚拟节点转化成真实节点\n    if (oldVnode.nodeType === 1) {\n        let el = createElm(vnode); // 产生真实的dom \n        let parentElm = oldVnode.parentNode; // 获取老的app的父亲 =》 body\n    \n        parentElm.insertBefore(el,oldVnode.nextSibling); // 当前的真实元素插入到app的后面\n        parentElm.removeChild(oldVnode); // 删除老的节点\n        return el;\n    } else {\n        // 在更新的时 拿老的虚拟节点 和 新的虚拟节点做对比 ，将不同的地方更新真实的dom\n        // 更新功能\n        // 那当前节点 整个\n        // 1.比较两个元素的标签 ，标签不一样直接替换掉即可 parentNode.replaceChild(newel, oldel)\n        if (oldVnode.tag !== vnode.tag) {\n            return oldVnode.el.parentNode.replaceChild(createElm(vnode), oldVnode.el)\n        }\n        // 剩下的是标签一样的\n        // 2.有种可能是标签一样 <div>1</div>   <div>2</div>\n        //  文本节点的虚拟节点tag 都是undefined 文本替换用 DOMElemnt.textContent = newVal\n        if (!oldVnode.tag) {\n            if (oldVnode.text !== vnode.text) {\n                return oldVnode.el.textContent= vnode.text\n            }\n        }\n        // 3.其他情况 开始比对标签的属性 和 儿子了\n        // 可以复用老节点了，el是一个DOMElement对象，只改变el里属性或者孩子即可\n        // 所以可以把老vnode的el赋值给新vnode\n        let el = vnode.el = oldVnode.el\n        // 3.1 更新属性，用新的虚拟节点的属性和老的比较，去更新节点\n        // 新老属性做对比\n        updateProperties(vnode, oldVnode.data)\n        \n        // 比较孩子\n\n        let oldChildren = oldVnode.children || [];\n        let newChildren = vnode.children || [];\n\n        if (oldChildren.length > 0 && newChildren.length > 0) {\n            // 老的有儿子 新的也有儿子  diff 算法\n            updateChildren(oldChildren, newChildren, el);\n        } else if (oldChildren.length > 0) { // 新的没有\n            el.innerHTML = '';\n        } else if (newChildren.length > 0) { // 老的没有\n            for (let i = 0; i < newChildren.length; i++) {\n                let child = newChildren[i];\n                // 浏览器有性能优化 不用自己在搞文档碎片了\n                el.appendChild(createElm(child));\n            }\n        }\n        return el\n    }\n\n}\nfunction isSameVnode(oldVnode, newVnode) {\n    return (oldVnode.tag == newVnode.tag) && (oldVnode.key == newVnode.key);\n}\n// 儿子间的比较\nfunction updateChildren(oldChildren, newChildren, parent) {\n\n    // 开头指针\n    let oldStartIndex = 0; // 老的索引\n    let oldStartVnode = oldChildren[0]; // 老的索引指向的节点\n    let oldEndIndex = oldChildren.length - 1;\n    let oldEndVnode = oldChildren[oldEndIndex];\n\n\n    let newStartIndex = 0; // 老的索引\n    let newStartVnode = newChildren[0]; // 老的索引指向的节点\n    let newEndIndex = newChildren.length - 1;\n    let newEndVnode = newChildren[newEndIndex];\n    // vue 中的diff算做了很多了优化\n    // DOM中操作有很多常见的逻辑 把节点插入到当前儿子的头部、尾部、儿子倒叙正序\n    // vue2中采用的是双指针的方式\n\n    // 在尾部添加\n\n    // 我要做一个循环，同时循环老的和新的，哪个先结束 循环就停止，将多余的删除或者添加进去\n    // 比较谁先循环停止  || 一个true就继续  && 俩都得true\n\n    function makeIndexByKey(children) {\n        let map = {}\n        children.forEach((item,index)=>{\n            if(item.key){\n                map[item.key] = index; // {A0,B:1,c:2,d:3}\n            }\n        });\n        return map;\n    }\n    let map = makeIndexByKey(oldChildren);\n    while (oldStartIndex <= oldEndIndex && newStartIndex <= newEndIndex) {\n        if(!oldStartVnode){ // 指针指向了null 跳过这次的处理\n            oldStartVnode = oldChildren[++oldStartIndex]\n        }else if(!oldEndVnode){\n            oldEndVnode = oldChildren[--oldEndIndex];\n        }else if (isSameVnode(oldStartVnode, newStartVnode)) { // 如果俩人是同一个元素，比对儿子 \n            patch(oldStartVnode, newStartVnode); // 更新属性和再去递归更新子节点\n            oldStartVnode = oldChildren[++oldStartIndex];\n            newStartVnode = newChildren[++newStartIndex];\n        } else if (isSameVnode(oldEndVnode, newEndVnode)) {\n            patch(oldEndVnode, newEndVnode);\n            oldEndVnode = oldChildren[--oldEndIndex];\n            newEndVnode = newChildren[--newEndIndex];\n        } else if (isSameVnode(oldStartVnode, newEndVnode)) { // 老的尾部和新的头部比较\n            patch(oldStartVnode, newEndVnode);\n            // 将当前元素插入到尾部的 下一个元素的前面\n            parent.insertBefore(oldStartVnode.el, oldEndVnode.el.nextSibling);\n            oldStartVnode = oldChildren[++oldStartIndex];\n            newEndVnode = newChildren[--newEndIndex];\n        } else if (isSameVnode(oldEndVnode, newStartVnode)) {\n            patch(oldEndVnode, newStartVnode);\n            parent.insertBefore(oldEndVnode.el, oldStartVnode.el);\n            oldEndVnode = oldChildren[--oldEndIndex];\n            newStartVnode = newChildren[++newStartIndex];\n            // 为什么要有key，循环的时候为什么不能用index作为key\n        } else {\n            // 儿子之间没关系 ..... 暴力比对\n            let moveIndex = map[newStartVnode.key]; // 拿到开头的虚拟节点的key 去老的中找\n            if(moveIndex == undefined){ // 不需要移动说明没有key复用的\n                parent.insertBefore(createElm(newStartVnode),oldStartVnode.el)\n            }else{\n                let moveVNode = oldChildren[moveIndex]; // 这个老的虚拟节点需要移动\n                patch(moveVNode,newStartVnode); // 比较属性和儿子\n                parent.insertBefore(moveVNode.el,oldStartVnode.el); // 移动功能,dom映射\n                oldChildren[moveIndex] = null;\n            }\n            newStartVnode = newChildren[++newStartIndex]; // 用新的不停的去老的里面找\n        }\n\n        // 反转节点， 头部移动尾部 尾部移动到头部\n    }\n    if (newStartIndex <= newEndIndex) {\n        for (let i = newStartIndex; i <= newEndIndex; i++) {\n            // 将新的多余的插入进去即可 ,可能是向前添加 还有可能是向后添加\n            // parent.appendChild(createElm(newChildren[i]));\n            // 向后插入 ele = null\n            // 像前插入 ele 就是当前像谁前面插入\n            let ele = newChildren[newEndIndex + 1] == null ? null : newChildren[newEndIndex + 1].el\n            parent.insertBefore(createElm(newChildren[i]), ele);\n        }\n    }\n    // 老的节点还有没处理的，说明这些老节点是不需要的节点，如过这里面有null说明，这个节点已经被处理过了，跳过即可\n    if(oldStartIndex <= oldEndIndex){\n        for (let i = oldStartIndex; i <= oldEndIndex; i++) {\n            let child = oldChildren[i];\n            if(child != null){\n                parent.removeChild(child.el);\n            }\n        }\n    }\n}\nfunction createComponent(vnode){\n    // 调用hook中init方法 \n    let i = vnode.data;\n    if((i = i.hook) && (i = i.init)){ // i就是init方法\n        i(vnode); // 内部会去new 组件 会将实例挂载在vnode上\n    }\n    if(vnode.componentInstance){ // 如果是组件返回true\n        return true;\n    }\n}\n/**\n * tag,children,key,data,text vnode上的几个属性\n * @param {Object} vnode 虚拟节点\n */\nexport function createElm(vnode){\n    let {tag,children,key,data,text} = vnode;\n    if(typeof tag == 'string'){ // 创建元素 放到vnode.el上\n        if(createComponent(vnode)){ // 组件渲染后的结果 放到当前组件的实例上 vm.$el\n            return vnode.componentInstance.$el; // 组件对应的dom元素\n        }\n        vnode.el = document.createElement(tag);\n        // 只有元素才有属性\n        updateProperties(vnode);\n        children && children.forEach(child=>{ // 遍历儿子 将儿子渲染后的结果扔到父亲中\n            vnode.el.appendChild(createElm(child));\n        })\n    }else{ // 创建文件 放到vnode.el上\n        vnode.el = document.createTextNode(text);\n    }\n    return vnode.el;\n}\n\n// vue 的渲染流程 =》 先初始化数据 =》 将模板进行编译 =》 render函数 =》 生成虚拟节点 =》 生成真实的dom  =》 扔到页面上\n\n/**\n * \n * @param {*} vnode \n * @param {*} oldProps 旧节点的属性对象 oldVnode.data\n */\nfunction updateProperties(vnode, oldProps = {}){\n    let newProps = vnode.data || {}\n    let el = vnode.el;\n    // 1. 老得有，新的没有 删掉老得 DOMElement.removeAttribute()\n    for (let key in oldProps) {\n        if (!newProps[key]) {\n            el.removeAttribute(key)\n        }\n    }\n    // 2. 比对样式\n    let newStyle = newProps.style || {}\n    let oldStyle = oldProps.style || {}\n    // 老的样式中有 新的没有 删除老的样式\n    for (let key in oldStyle) {\n        if (!newStyle[key]) {\n            el.style[key] = '';\n        }\n    }\n    // 2. 老得没有，新的有 那就直接用新的去做更新即可\n    for(let key in newProps){\n        if(key == 'style'){ // {color:red}\n            for(let styleName in newProps.style){\n                el.style[styleName] = newProps.style[styleName]\n            }\n        }else if(key == 'class'){\n            el.className = newProps.class;\n        }else{\n            el.setAttribute(key,newProps[key]);\n        }\n    }\n}","import { patch } from \"./vdom/patch\";\nimport { callHook } from \"./util\";\nimport Watcher from './observer/watcher'\nexport function lifeCycleMixin (Vue) {\n  Vue.prototype._update = function (vnode) {\n    const vm = this\n    // 用新的创建的元素 替换老的vm.$el\n    vm.$el = patch(vm.$el,vnode)\n  }\n}\n\nexport function mountComponent (vm, el) {\n  vm.$el = el;\n  // 调用render方法去渲染 el属性\n  // 先调用render方法创建虚拟节点，在将虚拟节点渲染到页面上\n  callHook(vm,'beforeMount')\n  let updateComponent = ()=>{\n      vm._update(vm._render()); // 渲染 、 更新\n  }\n  // 这个watcher是用于渲染的 目前没有任何功能  updateComponent()\n\n  // 初始化就会创建watcher\n  let watcher = new Watcher(vm,updateComponent,()=>{\n      callHook(vm,'updated')\n  },true); // 渲染watcher 只是个名字\n\n  // 要把属性 和 watcher绑定在一起 \n  \n  callHook(vm,'mounted');\n}\n","import { initState } from \"./state\"\nimport { compileToFunctions } from \"./compiler/index\"\nimport { mountComponent } from \"./lifecycle\";\nimport { mergeOptions, callHook } from \"./util\";\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    const vm = this // 实例\n    // 要把全局的合并一起\n    vm.$options = mergeOptions(vm.constructor.options, options) // 属性挂在实例的$options\n    callHook(vm, 'beforeCreate')\n    initState(vm)\n    callHook(vm, 'created')\n    if(vm.$options.el){\n      vm.$mount(vm.$options.el)\n    }\n  }\n  Vue.prototype.$mount = function (el) {\n    const vm = this;\n    const options = vm.$options;\n    el = document.querySelector(el);\n    if(!options.render){\n      // 没render 将template转化成render方法\n      let template = options.template;\n      if(!template && el){\n          template = el.outerHTML;\n      }\n      // 编译原理 将模板编译成render函数\n      const render = compileToFunctions(template);\n      options.render = render\n    }\n    // 都解析成render函数之后，挂载组件\n    mountComponent(vm,el);\n  }\n}\n","import { isReservedTag } from \"../util\";\n\nexport function renderMixin(Vue) { // 用对象来描述dom的解构\n  Vue.prototype._c = function() { // 创建虚拟dom元素\n      return createElement(this, ...arguments);\n  }\n\n  // 1.当结果是对象时 会对这个对象取值\n  Vue.prototype._s = function(val) { // stringify\n      return val == null ? '' : (typeof val == 'object') ? JSON.stringify(val) : val;\n  }\n  Vue.prototype._v = function(text) { // 创建虚拟dom文本元素\n      return createTextVnode(text);\n  }\n  Vue.prototype._render = function() { // _render = render\n      const vm = this;\n      const render = vm.$options.render;\n      let vnode = render.call(vm);\n      return vnode;\n  }\n}\n// _c('div',{},_v(),_c())\nfunction createElement(vm, tag,data={},...children){\n  if (isReservedTag(tag)) {\n    return vnode(tag,data,data.key,children)\n  }\n  // 如果是组件，产生虚拟节点时需要把组件的构造函数传入, new VueCompnent().$mount\n  let Ctor = vm.$options.components[tag]\n  return createCompnent(vm, tag, data, data.key, children, Ctor)\n}\n\nfunction createCompnent (vm, tag, data, key, children, Ctor) {\n  // 组件的children是chachao\n  const baseCtor = vm.$options._base // Vue构造器\n  // Ctor可能是对象，也可能是构造函数\n  if (typeof Ctor === 'object') {\n    Ctor = baseCtor.extend(Ctor) // 返回一个Vuecomponet构造函数（继承Vue构造函数）\n  }\n  // 给组件增加生命周期\n  data.hook = { // 稍后初始化，会调用init\n    init () {}\n  }\n  return vnode(`vue-compnent-${Ctor.cid}-${tag}`, data, key, undefined, undefined, {\n    Ctor, children\n  })\n}\n\nfunction createTextVnode(text){\n  return vnode(undefined,undefined,undefined,undefined,text);\n}\n// 用来产生虚拟dom的,操作真实dom浪费性能\nfunction vnode(tag,data,key,children,text){\n  return {\n      tag,\n      data,\n      key,\n      children,\n      text,\n  }\n}","import { mergeOptions } from \"../util\";\n\nexport default function initExtend(Vue){\n    let cid = 0;\n    // 核心就是创造一个子类继承我们的父类\n    Vue.extend = function (extendOptions) {\n        // 如果对象相同 应该复用构造函数 （缓存）\n        const Super = this;\n        const Sub = function VueComponent(options) {\n            this._init(options);\n        }\n        Sub.cid = cid++;\n        // 子类要继承父类原型上的方法, 原型继承\n        Sub.prototype = Object.create(Super.prototype);\n        Sub.prototype.constructor = Sub;\n        // 处理其他的属性 mixin component ....\n        Sub.options = mergeOptions(\n            Super.options,\n            extendOptions\n        )\n        Sub.components = Super.components;\n        // ....    \n        return Sub;\n    }\n}\n\n\n// 组件的渲染流程\n// 1.调用Vue.component\n// 2.内部用的是Vue.extend 就是产生一个子类来继承父类 \n// 3.等会创建子类实例时会调用父类的_init方法，在$mount即可\n// 4.组件的初始化就是 new 这个组件的构造函数并且调用$mount方法\n// 5.创建虚拟节点 根据标签晒出组件对应，生成组件的虚拟节点 componentOptions里面包含Ctor,children \n\n// 6.组件创建真实dom时 （先渲染的是父组件） 遇到是组件的虚拟节点时，去调用init方法，让组件初始化并挂载， 组件的$mount无参数会把渲染后的dom放到 vm.$el上 =》 vnode.componentInstance中,这样渲染时就 获取这个对象的$el属性来渲染","import { mergeOptions } from \"../util\"\nimport initExtend from \"./extend\";\n\n// 全局api\nexport function initGlobalApi (Vue) {\n  Vue.options = {}\n  // 要将mixin合并到去全局配置中\n  Vue.mixin = function(mixin) {\n    this.options = mergeOptions(this.options, mixin)\n  }\n  /*\n   Vue.component('my-button', {\n    name: 'my-button',\n    template:'<button>{{a}}</button>',\n    created(){\n      console.log('child created')\n    },\n    ...\n   })\n   */\n  Vue.options._base = Vue\n  Vue.options.components = {}\n  initExtend(Vue)\n\n  // initAssetRegisters....  directive filter\n  Vue.component = function (id,definition) {\n    // Vue.extend \n    definition.name = definition.name || id; // 默认会以name属性为准\n    // 根据当前组件对象 生成了一个子类的构造函数\n    // 用的时候得 new definition().$mount()\n    definition = this.options._base.extend(definition); // 永远是父类\n\n    // Vue.component 注册组件 等价于  Vue.options.components[id] = definition\n    Vue.options.components[id] = definition;\n  }\n}\n","import { initMixin } from \"./init.js\"\nimport { renderMixin } from \"./vdom/index\";\nimport { lifeCycleMixin } from \"./lifecycle.js\";\nimport { initGlobalApi } from \"./global-api/index.js\";\nimport { stateMixin } from \"./state.js\";\n\nfunction Vue (options) {\n  this._init(options)\n}\ninitGlobalApi(Vue)\ninitMixin(Vue)\nlifeCycleMixin(Vue)\nrenderMixin(Vue)\nstateMixin(Vue)\n\n// 初始化方法\n\n// // 为了看到diff的整个流程 创建两个虚拟节点来进行比对操作\n// import {compileToFunctions} from './compiler/index';\n// import {createElm,patch} from './vdom/patch'\n// let vm1 = new Vue({data:{name:'zf'}});\n// /**\n//    <li style=\"background:red\" key=\"A\">A</li> \n//    <li style=\"background:yellow\" key=\"B\">B</li>\n//    <li style=\"background:pink\" key=\"C\">C</li>\n//    <li style=\"background:green\" key=\"D\">D</li>\n//    <li style=\"background:green\" key=\"F\">F</li>\n//  */\n// let render1 = compileToFunctions(`<ul class=\"a\" style=\"color:red\">\n// <li style=\"background:red\" key=\"A\">A</li> \n//    <li style=\"background:yellow\" key=\"B\">B</li>\n//    <li style=\"background:pink\" key=\"C\">C</li>\n//    <li style=\"background:green\" key=\"D\">D</li>\n//    <li style=\"background:green\" key=\"F\">F</li>\n// </ul>`);\n// let vnode1 = render1.call(vm1); // render方法返回的是虚拟dom\n\n// document.body.appendChild(createElm(vnode1))\n\n// let vm2 = new Vue({data:{name:'jw'}});\n// /**\n//  * \n   \n//  */\n// let render2 = compileToFunctions(`<ul class=\"a\" style=\"color:#fff\">\n//    <li style=\"background:red\" key=\"Z\">Z</li>\n//    <li style=\"background:green\" key=\"M\">M</li>\n//    <li style=\"background:pink\" key=\"B\">B</li>\n//    <li style=\"background:yellow\" key=\"A\">A</li>\n//    <li style=\"background:red\" key=\"Q\">Q</li>\n// </ul>`);\n// let vnode2 = render2.call(vm2); // render方法返回的是虚拟dom\n\n// // 用新的虚拟节点对比老的虚拟节点，找到差异 去更新老的dom元素\n\n\n// setTimeout(() => {\n//    patch(vnode1,vnode2); // 传入新的虚拟节点和老的 做一个对比\n// }, 3000);\n\nexport default Vue"],"names":["proxy","vm","data","key","Object","defineProperty","get","set","val","target","value","enumerable","configurable","LIFECYCLE_HOOKS","strats","components","parentVal","childVal","res","create","forEach","hook","mergeHook","concat","mergeOptions","parent","child","options","mergeField","hasOwnProperty","callHook","handlers","$options","handler","call","callbacks","pending","flushCallbacks","console","log","length","cb","shift","timerFunc","Promise","resolve","then","MutationObserver","observe","textNode","document","createTextNode","characterData","textContent","setImmediate","setTimeout","nextTick","push","makeMap","str","mapping","list","split","i","isReservedTag","oldArrayProtoMethods","Array","prototype","arrayMethods","methods","method","args","result","apply","inserted","ob","__ob__","slice","observeArray","dep","notify","id","Dep","subs","addDep","watcher","update","pushTarget","popTarget","Observer","isArray","__proto__","walk","keys","defineReactive","valueObserver","depend","newValue","has","queue","queueWatcher","flushSchedulerQueue","run","user","Watcher","exprOrFn","deps","depsId","Set","lazy","dirty","getter","path","obj","add","addSub","oldValue","initState","opts","props","initData","watch","initWatch","computed","initComputed","_data","handle","createWatcher","$watch","stateMixin","Vue","$nextTick","immediate","watchers","_computedWathcers","userDef","defineComputed","definition","createComputedGetter","evaluate","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHTML","html","createASTElement","tagName","attrs","tag","type","children","root","currentParent","stack","start","element","end","pop","chars","text","trim","textEnd","indexOf","startTagMatch","parseStartTag","endTagMatch","match","advance","substring","n","attr","name","defaultTagRE","genProps","item","JSON","stringify","gen","node","generate","test","tokens","lastIndex","index","exec","join","genChildren","el","map","code","compileToFunctions","template","ast","render","Function","patch","oldVnode","vnode","nodeType","createElm","parentElm","parentNode","insertBefore","nextSibling","removeChild","replaceChild","updateProperties","oldChildren","newChildren","updateChildren","innerHTML","appendChild","isSameVnode","newVnode","oldStartIndex","oldStartVnode","oldEndIndex","oldEndVnode","newStartIndex","newStartVnode","newEndIndex","newEndVnode","makeIndexByKey","moveIndex","undefined","moveVNode","ele","createComponent","init","componentInstance","$el","createElement","oldProps","newProps","removeAttribute","newStyle","style","oldStyle","styleName","className","setAttribute","lifeCycleMixin","_update","mountComponent","updateComponent","_render","initMixin","_init","constructor","$mount","querySelector","outerHTML","renderMixin","_c","arguments","_s","_v","createTextVnode","Ctor","createCompnent","baseCtor","_base","extend","cid","initExtend","extendOptions","Super","Sub","VueComponent","initGlobalApi","mixin","component"],"mappings":"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"}